<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<script src="jquery-ui-1.12.1.custom/external/jquery/jquery.js"></script>

<script src="jquery-ui-1.12.1.custom/jquery-ui.js"></script>
<link rel="stylesheet" href="jquery-ui-1.12.1.custom/jquery-ui.css">
<link rel="stylesheet" href="jquery-ui-1.12.1.custom/jquery-ui.structure.css">
<link rel="stylesheet" href="jquery-ui-1.12.1.custom/jquery-ui.theme.css">

<script>
	$(function() {
		$("#accordion").accordion();
		
		// read list from server
		syncGpsInfoListWithServer();
	});
	//选择经度
	function selectorWE() {
		var objSelect = $("#select_lat");
		var optionSelected = objSelect.children('option').val();
		alert("当前选择的是：" +optionSelected);
		
	}
	//保存
	function save() {
		var inPhone = $("#phone").val();
		var latVal = $("#lat").val();
		var lgtVal = $("#lgt").val();
		if(!inPhone) {
			alert("请输入手机号码");
			return null;
		}
		if(!latVal) {
			alert("请输入经度");
			return null;
		}
		if(!lgtVal) {
			alert("请输入纬度");
			return null;
		}
		$.ajax({
			type:"get",
			url: "http://localhost:8080/autonav/gpsinfo/insert",
			data: {
				"phone": inPhone,
				"latitude":latVal,
				"longtitude":lgtVal
			},
			success:function(){
				alert("保存成功")
				/* $("#save_tip").attr("value","保存成功")；*/
				$("#phone").attr("value","");
				$("#lat").attr("value","");
				$("#lgt").attr("value",""); 
			},
			error:function () {	
			}
		});
	}
	//查询
	function search() {
		alert("search hahah ");
	}

	function syncGpsInfoListWithServer() {
		$.ajax({
			type:"get",
			url: "http://localhost:8080/autonav/gpsinfo/list",
			data: {},
			success:function(data){
				replaceGpsInfoList(data);
			},
			error:function () {
				alert("read fail");
			}
		});
	}	

	function replaceGpsInfoList(data) {
	    var rootDiv = $("#gps_info_list");
        rootDiv.empty();
		$.each(data, function(index, item) {
			var phone = "手机号：" + item.phone;
			var lat = "经度:" + item.latitude;
			var lgt = "纬度:" + item.longtitude;
			var itemDiv = "<div id='list_item ui-widget ui-corner-all'><button >" + phone + "</button><br>"+ lat+ "</br>"+ lgt + "</br><button delbyId='" +item.id+ "'>删除</button></div>";
			rootDiv.add(itemDiv);
		});
	}

</script>
<title>自动导航</title>
</head>
<body>
	<style>
.div_body_head {
	width: 100%;
	height: auto;
}

div {
	height: 100%;
}

.divsame {
	float: left
}

.option {
	width: 30%;
	border-right: 1px solid #00F
}
.option .accordion {width: 30%;}

.list {
	width: 65%
}
.list_item{margin:5px;}
</style>
	<div class="div_body_head">
		hello,welcome to autoNav!</br>
		<div class="divsame options">
		<div id="accordion">
				<h3>添加</h3>
				<div>
					手机：<input type="tel" name="phone" id="phone" value=""/></br>
					经度：<!-- <select id="select_lat" onchange="selectorWE()"><option value="W">东经</option><option value="E">西经</option></select> --><input type="text" name="lat" id="lat" value=""/></br>
					纬度：<!-- <select><option value="lgtN">北纬</option><option value="ltgS">南纬</option></select> --><input type="text" name="lgt" id="lgt" value=""/></br>
					<input type="button" name="add" id="add" value="保存" onclick="save()"/>
					<input type="hidden" id="save_tip" value="saaaaa"/>
				</div>
				<h3>查询</h3>
				<div>
					请输入您要查询的手机号</br>
					<input type="text" name="search_by_phone"/></br>
					<input type="button" name="search" value="查询" onclick="search()"/> 
					
				</div>
			</div></div>
		<div class="divsame list" id="gps_info_list">
		</div>
	</div>
</body>
</html>